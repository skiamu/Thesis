RMSE <- sqrt(sum((pred[,1] - Y.true)^2) / length(Y.true));print(RMSE)
ME <- mean(e);print(ME)
MAD <- mean(abs(e));print(MAD)
myYear.new <- c(2001,2011)
z <- Design_Matrix_pred(myYear = myYear.new,
myInd = c(myInd,myInd.continum),
myCountry = NULL,
response.vector = T)
Y.true <- z$Y
X0.new <- z$XD
nations <- z$nations
d <- data.frame(Y.true,X0.new);
rownames(d) <- nations
X <- find_outlier(d,remove = T)
Y.true <- X[,1];X0.new <- X[,-1]
print(dim(X0.new)[1])
naz <- setdiff(nations,nazioni)
z <- Design_Matrix_pred(myYear = myYear.new,
myInd = c(myInd,myInd.continum),
myCountry = naz,
response.vector = T)
colnames(X0.new) <- gsub("\\(.*$", "", colnames(X0.new))
colnames(X0.new) <- gsub("\\,.*$", "", colnames(X0.new))
name <- colnames(X0.new)
X0.new[,name[3]] <- log(X0.new[,name[3]])
X0.new[,name[8]] <- 1/X0.new[,name[8]]
colnames(X0.new)[1:9] <- c("fertility","FDI","GDP","investment","education","consumi",
"inflation","health","openess")
formula.pred <- formula
fit.pred <- lm(formula.pred, data = data.frame(Y,XD))
summary(fit.pred)
pred <- predict(fit.pred, newdata = X0.new, interval = "confidence" )
true.pred <- data.frame(True = Y.true,pred = pred[,1])
rownames(true.pred) <- rownames(X0.new)
e <- Y.true - pred[,1]
RMSE <- sqrt(sum((pred[,1] - Y.true)^2) / length(Y.true));print(RMSE)
ME <- mean(e);print(ME)
MAD <- mean(abs(e));print(MAD)
true.pred.e <- cbind(true.pred,e)
myYear.new <- c(1973,1973)
z <- Design_Matrix_pred(myYear = myYear.new,
myInd = c(myInd,myInd.continum),
myCountry = NULL,
response.vector = T)
Y.true <- z$Y
X0.new <- z$XD
nations <- z$nations
d <- data.frame(Y.true,X0.new);
rownames(d) <- nations
X <- find_outlier(d,remove = T)
Y.true <- X[,1];X0.new <- X[,-1]
print(dim(X0.new)[1])
naz <- setdiff(nations,nazioni)
myYear.new <- c(1973,1983)
z <- Design_Matrix_pred(myYear = myYear.new,
myInd = c(myInd,myInd.continum),
myCountry = NULL,
response.vector = T)
Y.true <- z$Y
X0.new <- z$XD
nations <- z$nations
d <- data.frame(Y.true,X0.new);
rownames(d) <- nations
X <- find_outlier(d,remove = T)
Y.true <- X[,1];X0.new <- X[,-1]
print(dim(X0.new)[1])
naz <- setdiff(nations,nazioni)
colnames(X0.new) <- gsub("\\(.*$", "", colnames(X0.new))
colnames(X0.new) <- gsub("\\,.*$", "", colnames(X0.new))
name <- colnames(X0.new)
X0.new[,name[3]] <- log(X0.new[,name[3]])
X0.new[,name[8]] <- 1/X0.new[,name[8]]
colnames(X0.new)[1:9] <- c("fertility","FDI","GDP","investment","education","consumi",
"inflation","health","openess")
formula.pred <- formula
fit.pred <- lm(formula.pred, data = data.frame(Y,XD))
summary(fit.pred)
pred <- predict(fit.pred, newdata = X0.new, interval = "confidence" )
true.pred <- data.frame(True = Y.true,pred = pred[,1])
rownames(true.pred) <- rownames(X0.new)
e <- Y.true - pred[,1]
RMSE <- sqrt(sum((pred[,1] - Y.true)^2) / length(Y.true));print(RMSE)
ME <- mean(e);print(ME)
MAD <- mean(abs(e));print(MAD)
myYear.new <- c(1990,2000)
z <- Design_Matrix_pred(myYear = myYear.new,
myInd = c(myInd,myInd.continum),
myCountry = NULL,
response.vector = T)
Y.true <- z$Y
X0.new <- z$XD
nations <- z$nations
d <- data.frame(Y.true,X0.new);
rownames(d) <- nations
X <- find_outlier(d,remove = T)
Y.true <- X[,1];X0.new <- X[,-1]
print(dim(X0.new)[1])
naz <- setdiff(nations,nazioni)
colnames(X0.new) <- gsub("\\(.*$", "", colnames(X0.new))
colnames(X0.new) <- gsub("\\,.*$", "", colnames(X0.new))
name <- colnames(X0.new)
X0.new[,name[3]] <- log(X0.new[,name[3]])
X0.new[,name[8]] <- 1/X0.new[,name[8]]
colnames(X0.new)[1:9] <- c("fertility","FDI","GDP","investment","education","consumi",
"inflation","health","openess")
formula.pred <- formula
fit.pred <- lm(formula.pred, data = data.frame(Y,XD))
summary(fit.pred)
pred <- predict(fit.pred, newdata = X0.new, interval = "confidence" )
true.pred <- data.frame(True = Y.true,pred = pred[,1])
rownames(true.pred) <- rownames(X0.new)
e <- Y.true - pred[,1]
RMSE <- sqrt(sum((pred[,1] - Y.true)^2) / length(Y.true));print(RMSE)
ME <- mean(e);print(ME)
MAD <- mean(abs(e));print(MAD)
true.pred.e <- cbind(true.pred,e)
rm(list = ls())
path <- "/home/andrea/StatApp/StatApp_test"
load(paste(path,"ReadData/data.RData",sep = "/"))
load(paste(path,"inference/mcshapiro.test.RData",sep = "/"))
source(paste(path,"function_extract.R",sep = "/"))
source(paste(path,"inference/rep_measure.R",sep = "/"))
source(paste(path,"inference/Inference_functions.R",sep = "/"))
source(paste(path,"inference/test_functions.R",sep = "/"))
source(paste(path,"outlier.R",sep = "/"))
source(paste(path,"gaussianity/is_gaussian.R",sep = "/"))
source(paste(path,"Regression/lin_reg.R",sep = "/"))
source(paste(path,"Regression/Design_Matrix.R",sep = "/"))
source(paste(path,"Regression/Design_Matrix_pred.R",sep = "/"))
library(MASS)
library(dplyr)
select <- dplyr::select
myInd <- c("Gross enrolment ratio, primary, both sexes (%)",
"Life expectancy at birth, total (years)",
"Fertility rate, total (births per woman)",
"Inflation, GDP deflator (annual %)",
"GDP per capita (constant 2005 US$)",
"Household final consumption expenditure, etc. (% of GDP)",
"Foreign direct investment, net inflows (% of GDP)")
myInd.continum <- c("General government final consumption expenditure (% of GDP)",
"Trade (% of GDP)")
myYear <- seq(1973,2003,by = 10)
myYear.continum <- myYear[1]:myYear[length(myYear)]
w <- Design_Matrix(myYear = myYear,
myYear.continum = NULL,
myInd = c(myInd, myInd.continum),
myInd.continum = NULL,
dummy.period = F)
Y <- w$Y
XD <- w$XD
n <- w$n
nazioni <- w$nazioni
M <- w$statistics
marginal.plot = T
colnames(XD) <- gsub("\\(.*$", "", colnames(XD))
colnames(XD) <- gsub("\\,.*$", "", colnames(XD))
name <- colnames(XD)
XD[,name[3]] <- log(XD[,name[3]])
XD[,name[8]] <- 1/XD[,name[8]]
colnames(XD)[1:9] <- c("fertility","FDI","GDP","investment","education","consumi",
"inflation","health","openess")
if(sum(is.na(XD)) != 0){stop("XD contiene na, correggere immediatamente")}
row.country.name <- rownames(XD)
rownames(XD) <- 1:length(Y)
formula <- Y ~ fertility+FDI+GDP+education+consumi+inflation+health+R1+R2+I1+I2+
investment+openess+
# interazioni con gli anni
I1:GDP + I1:fertility + I1:investment +
I2:GDP + I2:fertility + I2:investment +
# interazioni con asia
R1:GDP + R1:fertility + R1:investment+
# interazioni con africa sub-sahariana
R2:GDP + R2:fertility + R2:investment
fit <- lm(formula ,data = XD)
summary(fit)
plot(fit)
fit2 <- lm(formula,data = XD)
summary(fit2)
step(fit2)
formula <- Y ~ fertility + GDP + consumi + R1 + R2 + I1 + I2 +
investment + GDP:I1 + fertility:I1 + I1:investment + fertility:I2 +
I2:investment + GDP:R1 + fertility:R1 + fertility:R2 + R2:investment
fit3 <- lm(formula ,data = XD)
summary(fit3)
plot(fit3)
myYear <- seq(1983,2003,by = 10)
myYear.continum <- myYear[1]:myYear[length(myYear)]
w <- Design_Matrix(myYear = myYear,
myYear.continum = NULL,
myInd = c(myInd, myInd.continum),
myInd.continum = NULL,
dummy.period = F)
Y <- w$Y
XD <- w$XD
n <- w$n
nazioni <- w$nazioni
M <- w$statistics
marginal.plot = T
colnames(XD) <- gsub("\\(.*$", "", colnames(XD))
colnames(XD) <- gsub("\\,.*$", "", colnames(XD))
name <- colnames(XD)
XD[,name[3]] <- log(XD[,name[3]])
XD[,name[8]] <- 1/XD[,name[8]]
colnames(XD)[1:9] <- c("fertility","FDI","GDP","investment","education","consumi",
"inflation","health","openess")
if(sum(is.na(XD)) != 0){stop("XD contiene na, correggere immediatamente")}
row.country.name <- rownames(XD)
rownames(XD) <- 1:length(Y)
formula <- Y ~ fertility+FDI+GDP+education+consumi+inflation+health+R1+R2+I1+I2+
investment+openess+
# interazioni con gli anni
I1:GDP + I1:fertility + I1:investment +
I2:GDP + I2:fertility + I2:investment +
# interazioni con asia
R1:GDP + R1:fertility + R1:investment+
# interazioni con africa sub-sahariana
R2:GDP + R2:fertility + R2:investment
fit <- lm(formula ,data = XD)
summary(fit)
plot(fit)
d <- data.frame(Y,XD); rownames(d) <- row.country.name
XD <- find_outlier(d,remove = T)
Y <- XD[,1];XD <- XD[,-1]
fit2 <- lm(formula,data = XD)
summary(fit2)
step(fit2)
formula <- Y ~ fertility + FDI + GDP + R1 + R2 + I1 + I2 +
investment + fertility:I2 + GDP:R1 + fertility:R1 + GDP:R2
fit3 <- lm(formula ,data = XD)
summary(fit3)
plot(fit3)
rm(list = ls())
path <- "/home/andrea/StatApp/StatApp_test"
load(paste(path,"ReadData/data.RData",sep = "/"))
load(paste(path,"inference/mcshapiro.test.RData",sep = "/"))
source(paste(path,"function_extract.R",sep = "/"))
source(paste(path,"inference/rep_measure.R",sep = "/"))
source(paste(path,"inference/Inference_functions.R",sep = "/"))
source(paste(path,"inference/test_functions.R",sep = "/"))
source(paste(path,"outlier.R",sep = "/"))
source(paste(path,"gaussianity/is_gaussian.R",sep = "/"))
source(paste(path,"Regression/lin_reg.R",sep = "/"))
source(paste(path,"Regression/Design_Matrix.R",sep = "/"))
source(paste(path,"Regression/Design_Matrix_pred.R",sep = "/"))
library(MASS)
library(dplyr)
select <- dplyr::select
myInd <- c("Gross enrolment ratio, primary, both sexes (%)",
"Life expectancy at birth, total (years)",
"Fertility rate, total (births per woman)",
"Inflation, GDP deflator (annual %)",
"GDP per capita (constant 2005 US$)",
"Household final consumption expenditure, etc. (% of GDP)",
"Foreign direct investment, net inflows (% of GDP)")
myInd.continum <- c("General government final consumption expenditure (% of GDP)",
"Trade (% of GDP)")
myYear <- seq(1983,2013,by = 10)
myYear.continum <- myYear[1]:myYear[length(myYear)]
w <- Design_Matrix(myYear = myYear,
myYear.continum = NULL,
myInd = c(myInd, myInd.continum),
myInd.continum = NULL,
dummy.period = F)
Y <- w$Y
XD <- w$XD
n <- w$n
nazioni <- w$nazioni
M <- w$statistics
marginal.plot = T
colnames(XD) <- gsub("\\(.*$", "", colnames(XD))
colnames(XD) <- gsub("\\,.*$", "", colnames(XD))
name <- colnames(XD)
XD[,name[3]] <- log(XD[,name[3]])
XD[,name[8]] <- 1/XD[,name[8]]
colnames(XD)[1:9] <- c("fertility","FDI","GDP","investment","education","consumi",
"inflation","health","openess")
if(sum(is.na(XD)) != 0){stop("XD contiene na, correggere immediatamente")}
row.country.name <- rownames(XD)
rownames(XD) <- 1:length(Y)
formula <- Y ~ fertility+FDI+GDP+education+consumi+inflation+health+R1+R2+I1+I2+
investment+openess+
# interazioni con gli anni
I1:GDP + I1:fertility + I1:investment +
I2:GDP + I2:fertility + I2:investment +
# interazioni con asia
R1:GDP + R1:fertility + R1:investment+
# interazioni con africa sub-sahariana
R2:GDP + R2:fertility + R2:investment
fit <- lm(formula ,data = XD)
summary(fit)
plot(fit)
fit2 <- lm(formula,data = XD)
summary(fit2)
step(fit2)
formula <- Y ~ fertility + FDI + GDP + R1 + R2 + I1 + I2 +
investment + fertility:I2 + GDP:R1 + fertility:R1 + GDP:R2
fit3 <- lm(formula ,data = XD)
summary(fit3)
XD <- XD[-c(109,20,14,21),]; Y <- Y[-c(109,20,14,21)]
formula <- Y ~ fertility + FDI + GDP + R1 + R2 + I1 + I2 +
investment + fertility:I2 + GDP:R1 + fertility:R1 + GDP:R2
fit3 <- lm(formula ,data = XD)
summary(fit3)
XD <- XD[-c(109,20,14,21),]; Y <- Y[-c(109,20,14,21)]
formula <- Y ~ fertility + FDI + GDP + R1 + R2 + I1 + I2 +
investment + fertility:I2 + GDP:R1 + fertility:R1 + GDP:R2
fit3 <- lm(formula ,data = XD)
summary(fit3)
rm(list = ls())
path <- "/home/andrea/StatApp/StatApp_test"
load(paste(path,"ReadData/data.RData",sep = "/"))
load(paste(path,"inference/mcshapiro.test.RData",sep = "/"))
source(paste(path,"function_extract.R",sep = "/"))
source(paste(path,"inference/rep_measure.R",sep = "/"))
source(paste(path,"inference/Inference_functions.R",sep = "/"))
source(paste(path,"inference/test_functions.R",sep = "/"))
source(paste(path,"outlier.R",sep = "/"))
source(paste(path,"gaussianity/is_gaussian.R",sep = "/"))
source(paste(path,"Regression/lin_reg.R",sep = "/"))
source(paste(path,"Regression/Design_Matrix.R",sep = "/"))
source(paste(path,"Regression/Design_Matrix_pred.R",sep = "/"))
library(MASS)
library(dplyr)
select <- dplyr::select
myInd <- c("Gross enrolment ratio, primary, both sexes (%)",
"Life expectancy at birth, total (years)",
"Fertility rate, total (births per woman)",
"Inflation, GDP deflator (annual %)",
"GDP per capita (constant 2005 US$)",
"Household final consumption expenditure, etc. (% of GDP)",
"Foreign direct investment, net inflows (% of GDP)")
myInd.continum <- c("General government final consumption expenditure (% of GDP)",
"Trade (% of GDP)")
myYear <- seq(1983,2013,by = 10)
myYear.continum <- myYear[1]:myYear[length(myYear)]
w <- Design_Matrix(myYear = myYear,
myYear.continum = NULL,
myInd = c(myInd, myInd.continum),
myInd.continum = NULL,
dummy.period = F)
Y <- w$Y
XD <- w$XD
n <- w$n
nazioni <- w$nazioni
M <- w$statistics
marginal.plot = T
colnames(XD) <- gsub("\\(.*$", "", colnames(XD))
colnames(XD) <- gsub("\\,.*$", "", colnames(XD))
name <- colnames(XD)
XD[,name[3]] <- log(XD[,name[3]])
XD[,name[8]] <- 1/XD[,name[8]]
colnames(XD)[1:9] <- c("fertility","FDI","GDP","investment","education","consumi",
"inflation","health","openess")
if(sum(is.na(XD)) != 0){stop("XD contiene na, correggere immediatamente")}
row.country.name <- rownames(XD)
rownames(XD) <- 1:length(Y)
formula <- Y ~ fertility+FDI+GDP+education+consumi+inflation+health+R1+R2+I1+I2+
investment+openess+
# interazioni con gli anni
I1:GDP + I1:fertility + I1:investment +
I2:GDP + I2:fertility + I2:investment +
# interazioni con asia
R1:GDP + R1:fertility + R1:investment+
# interazioni con africa sub-sahariana
R2:GDP + R2:fertility + R2:investment
fit <- lm(formula ,data = XD)
summary(fit)
fit2 <- lm(formula,data = XD)
summary(fit2)
step(fit2)
formula <- Y ~ fertility + GDP + consumi + R1 + R2 + I1 + I2 +
investment + GDP:I1 + fertility:I1 + I1:investment + fertility:I2 +
I2:investment + GDP:R1 + fertility:R1 + fertility:R2 + R2:investment
fit3 <- lm(formula ,data = XD)
summary(fit3)
XD <- XD[-c(109,20,14,21),]; Y <- Y[-c(109,20,14,21)]
formula <- Y ~ fertility + GDP + consumi + R1 + R2 + I1 + I2 +
investment + GDP:I1 + fertility:I1 + I1:investment + fertility:I2 +
I2:investment + GDP:R1 + fertility:R1 + fertility:R2 + R2:investment
fit3 <- lm(formula ,data = XD)
summary(fit3)
myInd <- c("Gross enrolment ratio, primary, both sexes (%)",
"Life expectancy at birth, total (years)",
"Fertility rate, total (births per woman)",
"Inflation, GDP deflator (annual %)",
"GDP per capita (constant 2005 US$)",
"Household final consumption expenditure, etc. (% of GDP)",
"Foreign direct investment, net inflows (% of GDP)")
myInd.continum <- c("General government final consumption expenditure (% of GDP)",
"Trade (% of GDP)")
myYear.new <- c(2003,2013)
z <- Design_Matrix_pred(myYear = myYear.new,
myInd = c(myInd,myInd.continum),
myCountry = NULL,
response.vector = T)
Y.true <- z$Y
X0.new <- z$XD
nations <- z$nations
d <- data.frame(Y.true,X0.new);
rownames(d) <- nations
X <- find_outlier(d,remove = T)
Y.true <- X[,1];X0.new <- X[,-1]
print(dim(X0.new)[1])
naz <- setdiff(nations,nazioni)
naz
z <- Design_Matrix_pred(myYear = myYear.new,
myInd = c(myInd,myInd.continum),
myCountry = NULL,
response.vector = T)
Y.true <- z$Y
X0.new <- z$XD
nations <- z$nations
naz <- setdiff(nations,nazioni)
naz
naz <- c("Czech Republic","Poland","South Africa","Cambodia","Russia","UK",
"Germany","Belgium","Turkey","Slovenia","Mongolia","China" )
z <- Design_Matrix_pred(myYear = myYear.new,
myInd = c(myInd,myInd.continum),
myCountry = naz,
response.vector = T)
X0.new <- z$XD
Y.true <- z$Y
nations <- z$nations
colnames(X0.new) <- gsub("\\(.*$", "", colnames(X0.new))
colnames(X0.new) <- gsub("\\,.*$", "", colnames(X0.new))
name <- colnames(X0.new)
X0.new[,name[3]] <- log(X0.new[,name[3]])
X0.new[,name[8]] <- 1/X0.new[,name[8]]
colnames(X0.new)[1:9] <- c("fertility","FDI","GDP","investment","education","consumi",
"inflation","health","openess")
formula.pred <- formula
fit.pred <- lm(formula.pred, data = data.frame(Y,XD))
summary(fit.pred)
pred <- predict(fit.pred, newdata = X0.new, interval = "confidence" )
true.pred <- data.frame(True = Y.true,pred = pred[,1])
rownames(true.pred) <- rownames(X0.new)
e <- Y.true - pred[,1]
RMSE <- sqrt(sum((pred[,1] - Y.true)^2) / length(Y.true));print(RMSE)
ME <- mean(e);print(ME)
MAD <- mean(abs(e));print(MAD)
true.pred.e <- cbind(true.pred,e)
source(paste(path,"Regression/manual_stuff.R",sep = "/"))
myYear.new <- c(2013)
z <- Design_Matrix_pred(myYear = myYear.new,
myInd = c(myInd,myInd.continum),
myCountry = NULL,
response.vector = F)
X0.new <- z$XD
Y.true <- z$Y
nations <- z$nations
X0.new <- manual_stuff(X0.new)
pred <- predict(fit.pred, newdata = X0.new, interval = "confidence" )
source(paste(path,"Regression/web_data.R",sep = "/"))
naz
setwd("~/Thesis")
library(R.matlab)
library(ghyp)
load("mcshapiro.test.RData")
data(smi.stocks)
filename <- paste("stocks", ".mat", sep="")
writeMat(filename, smi.stocks=smi.stocks)
Returns <- readMat("Yahoo.mat"); Returns <- Returns$Returns
fitted.t <- fit.tmv(data = Returns,silent = T)
logLik(fitted.t)
filename <- paste("DistParam", ".mat", sep="")
writeMat(filename, fit.t=fitted.t)
filename <- paste("DistParam", ".mat", sep="")
writeMat(filename, fitted.t=fitted.t)
filename <- paste("DistParam", ".mat", sep="")
writeMat(filename, fitted.t=fitted.t)
fitted.NIG <- fit.NIGmv(data = Returns,silent = T)
logLik(fitted.NIG)
fitted.gauss <- fit.gaussmv(data = Returns)
logLik(fitted.gauss)
fitted.ghyp <- fit.ghypmv(data = Returns,silent = T)
logLik(fitted.ghyp)
fitted.t <- fit.tmv(data = Returns,silent = T)
logLik(fitted.t)
filename <- paste("stocks", ".mat", sep="")
writeMat(filename, smi.stocks=smi.stocks)
filename <- paste("DistParam", ".mat", sep="")
writeMat(filename, fitted.t=fitted.t)
filename
a = 5
writeMat(filename, a = a)
filename <- paste("DistParam", ".mat", sep="")
writeMat(filename, a = a)
filename <- paste("DistParam", ".mat", sep="")
writeMat(filename, dist = fitted.t)
?writeMat
dist <- fit.tmv(data = Returns,silent = T)
logLik(fitted.t)
writeMat(filename, dist = dist)
filename <- paste("DistParam", ".mat", sep="")
writeMat(filename, dist = dist)
dist
library(R.matlab)
library(ghyp)
load("mcshapiro.test.RData")
data(smi.stocks)
Returns <- readMat("Yahoo.mat"); Returns <- Returns$Returns
fitted.t <- fit.tmv(data = Returns,silent = T)
logLik(fitted.t)
fitted.t
fitted.ghyp
fitted.NIG <- fit.NIGmv(data = Returns,silent = T)
logLik(fitted.NIG)
fitted.gauss <- fit.gaussmv(data = Returns)
logLik(fitted.gauss)
fitted.ghyp <- fit.ghypmv(data = Returns,silent = T)
logLik(fitted.ghyp)
fitted.ghyp
